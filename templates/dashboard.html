{% extends "layout.html" %}
{% block title %}Dashboard | BeaconSEL{% endblock %}
{% block content %}

<div class="row justify-content-center">
  <div class="col-lg-10">
    <div class="text-center mb-4">
      <h1 class="display-6 fw-bold text-primary">📚 Saved SEL Lessons</h1>
      <p class="text-muted">Review and manage your generated lesson plans</p>
    </div>

    {% if lessons %}
      <div class="row g-4">
        {% for lesson in lessons %}
        {% if lesson.is_favorite %}
          <div class="col-md-6">
            <div class="card h-100 shadow-sm hover-card border-warning border-2">
              <div class="card-body">
                <h5 class="card-title text-primary">{{ lesson.grade }} – {{ lesson.subject }}</h5>
                <h6 class="card-subtitle mb-2 text-muted">
                  {{ lesson.sel_focus }} | {{ lesson.topic }}
                  {% if lesson.sped_focus %}
                  <br><span class="badge bg-info">🧩 {{ lesson.sped_focus }}</span>
                  {% endif %}
                </h6>
                {% if lesson.academic_standard %}
                <div class="mb-2">
                  <span class="badge bg-primary me-1">📚 {{ lesson.academic_standard }}</span>
                  {% if lesson.sel_standard %}
                  <span class="badge bg-warning">❤️ {{ lesson.sel_standard }}</span>
                  {% endif %}
                </div>
                {% endif %}
                <p class="card-text">{{ lesson.lesson_text[:200] }}...</p>
                <p class="text-muted mb-3"><small>{{ lesson.created_at.strftime('%Y-%m-%d %H:%M') }}</small></p>
                <a href="/lesson/{{ lesson.id }}" class="btn btn-warning btn-sm">📖 View Full Lesson</a>
              </div>
            </div>
          </div>
        {% else %}
          <div class="col-md-6">
            <div class="card h-100 shadow-sm hover-card">
              <div class="card-body">
                <h5 class="card-title text-primary">{{ lesson.grade }} – {{ lesson.subject }}</h5>
                <h6 class="card-subtitle mb-2 text-muted">
                  {{ lesson.sel_focus }} | {{ lesson.topic }}
                  {% if lesson.sped_focus %}
                  <br><span class="badge bg-info">🧩 {{ lesson.sped_focus }}</span>
                  {% endif %}
                </h6>
                {% if lesson.academic_standard %}
                <div class="mb-2">
                  <span class="badge bg-primary me-1">📚 {{ lesson.academic_standard }}</span>
                  {% if lesson.sel_standard %}
                  <span class="badge bg-warning">❤️ {{ lesson.sel_standard }}</span>
                  {% endif %}
                </div>
                {% endif %}
                <p class="card-text">{{ lesson.lesson_text[:200] }}...</p>
                <p class="text-muted mb-3"><small>{{ lesson.created_at.strftime('%Y-%m-%d %H:%M') }}</small></p>
                <a href="/lesson/{{ lesson.id }}" class="btn btn-warning btn-sm">📖 View Full Lesson</a>
              </div>
            </div>
          </div>
        {% endif %}
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-5">
        <div class="text-muted mb-3">
          <i class="fs-1">📝</i>
        </div>
        <h4 class="text-muted">No saved lessons yet</h4>
        <p class="text-muted">Generate your first lesson to see it appear here!</p>
        <a href="/" class="btn btn-warning">Create First Lesson</a>
      </div>
    {% endif %}

    <hr class="mt-5">
    <h4 class="text-primary mb-4">📘 Teaching Journal – Copilot Tips</h4>

    {% if tips %}
      <div class="row g-4">
        {% for tip in tips %}
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-header bg-light">
                <h6 class="mb-0">{{ tip.grade }} • {{ tip.subject }} • {{ tip.sel_focus }}</h6>
                {% if tip.topic %}
                <small class="text-muted">Topic: {{ tip.topic }}</small>
                {% endif %}
              </div>
              <div class="card-body" style="white-space: pre-wrap; font-size: 0.9rem;">
                {{ tip.content }}
              </div>
              <div class="card-footer text-muted">
                <small>Saved on {{ tip.created_at.strftime('%B %d, %Y at %I:%M %p') }}</small>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-4">
        <div class="text-muted mb-3">
          <i class="fs-1">📝</i>
        </div>
        <p class="text-muted">No Copilot tips saved yet. Use the Copilot feature on the main page and save helpful suggestions!</p>
      </div>
    {% endif %}

    <div class="text-center mt-4">
      <a href="/" class="btn btn-outline-secondary">← Back to Generator</a>
    </div>
  </div>
</div>

{% endblock %}